## 12.4 给关键部分加锁

对多线程程序中临界区加锁避免竞争条件。使用threading库中的Lock对象，就像下边例子：

```python
import threading 
class SharedCouter:
	'''
	a counter object that can be shared by multiple threads
	'''
	def __init__(self,inital_value=0):
		self._value=inital_value
		self._value_lock=threading.Lock()

	def incr(self,delta=1):
		'''		
		increment the counter with locking
		'''
		with self._value_lock:
			self._value+=delta
	def decr(self,delta=1):
		'''
		decrement the counter with locking
		'''
		with self._value_lock:
			self._value-=delta
```
Lock对象和with语句块一起使用可以保证互斥执行，执行结束自动释放。
